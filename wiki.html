<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Repair Wiki | Fixology</title>
  <meta name="description" content="Free device repair guides, tutorials, and troubleshooting tips for technicians.">
  <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>üîß</text></svg>">
  <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --bg-primary: #0a0a0f;
      --bg-secondary: #12121a;
      --bg-card: rgba(255, 255, 255, 0.03);
      --border-color: rgba(255, 255, 255, 0.08);
      --text-primary: #ffffff;
      --text-secondary: rgba(255, 255, 255, 0.7);
      --text-muted: rgba(255, 255, 255, 0.5);
      --accent-purple: #a78bfa;
      --accent-cyan: #06b6d4;
      --success: #10b981;
      --gradient-primary: linear-gradient(135deg, #a78bfa 0%, #06b6d4 100%);
    }
    body { font-family: 'Inter', sans-serif; background: var(--bg-primary); color: var(--text-primary); min-height: 100vh; }
    .navbar { display: flex; justify-content: space-between; align-items: center; padding: 1rem 2rem; background: rgba(10, 10, 15, 0.9); border-bottom: 1px solid var(--border-color); position: sticky; top: 0; z-index: 100; }
    .logo { display: flex; align-items: center; gap: 0.75rem; font-family: 'Space Grotesk', sans-serif; font-size: 1.5rem; font-weight: 700; color: var(--text-primary); text-decoration: none; }
    .logo-icon { width: 40px; height: 40px; background: var(--gradient-primary); border-radius: 10px; display: flex; align-items: center; justify-content: center; }
    .nav-links { display: flex; gap: 2rem; list-style: none; }
    .nav-links a { color: var(--text-secondary); text-decoration: none; font-weight: 500; }
    .nav-links a:hover { color: var(--accent-purple); }
    .hero { padding: 4rem 2rem; text-align: center; background: linear-gradient(180deg, rgba(167, 139, 250, 0.05) 0%, transparent 100%); }
    .hero-title { font-family: 'Space Grotesk', sans-serif; font-size: 2.75rem; font-weight: 700; margin-bottom: 1rem; }
    .hero-title span { background: var(--gradient-primary); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
    .hero-subtitle { color: var(--text-secondary); font-size: 1.125rem; max-width: 600px; margin: 0 auto 2rem; }
    .search-container { max-width: 640px; margin: 0 auto; position: relative; }
    .search-input { width: 100%; padding: 1.25rem 1.5rem 1.25rem 3.5rem; font-size: 1.125rem; background: var(--bg-secondary); border: 2px solid var(--border-color); border-radius: 16px; color: var(--text-primary); transition: all 0.2s; }
    .search-input:focus { outline: none; border-color: var(--accent-purple); box-shadow: 0 0 0 4px rgba(167, 139, 250, 0.15); }
    .search-icon { position: absolute; left: 1.25rem; top: 50%; transform: translateY(-50%); font-size: 1.25rem; }
    .container { max-width: 1100px; margin: 0 auto; padding: 3rem 2rem; }
    .categories { display: flex; gap: 0.75rem; flex-wrap: wrap; margin-bottom: 2rem; justify-content: center; }
    .category-btn { padding: 0.5rem 1rem; background: var(--bg-card); border: 1px solid var(--border-color); border-radius: 20px; color: var(--text-secondary); cursor: pointer; transition: all 0.2s; font-size: 0.9375rem; }
    .category-btn:hover, .category-btn.active { background: var(--accent-purple); border-color: var(--accent-purple); color: white; }
    .results-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1.5rem; }
    .results-count { color: var(--text-muted); font-size: 0.9375rem; }
    .articles-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(320px, 1fr)); gap: 1.5rem; }
    .article-card { background: var(--bg-secondary); border: 1px solid var(--border-color); border-radius: 16px; padding: 1.5rem; transition: all 0.2s; cursor: pointer; }
    .article-card:hover { border-color: var(--accent-purple); transform: translateY(-4px); }
    .article-category { display: inline-flex; align-items: center; gap: 0.5rem; font-size: 0.75rem; font-weight: 600; color: var(--accent-cyan); text-transform: uppercase; margin-bottom: 0.75rem; }
    .article-title { font-family: 'Space Grotesk', sans-serif; font-size: 1.25rem; font-weight: 600; margin-bottom: 0.5rem; }
    .article-excerpt { color: var(--text-secondary); font-size: 0.9375rem; line-height: 1.6; margin-bottom: 1rem; display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
    .article-meta { display: flex; gap: 1rem; font-size: 0.8125rem; color: var(--text-muted); }
    .article-meta span { display: flex; align-items: center; gap: 0.25rem; }
    .loading { text-align: center; padding: 3rem; color: var(--text-muted); }
    .no-results { text-align: center; padding: 3rem; color: var(--text-muted); }
    .no-results h3 { font-family: 'Space Grotesk', sans-serif; margin-bottom: 0.5rem; color: var(--text-primary); }
    @media (max-width: 640px) { .hero-title { font-size: 2rem; } .articles-grid { grid-template-columns: 1fr; } }
  </style>
</head>
<body>
  <nav class="navbar">
    <a href="index.html" class="logo"><span class="logo-icon">üîß</span><span>Fixology</span></a>
    <ul class="nav-links">
      <li><a href="diagnose.html">Diagnose</a></li>
      <li><a href="imei.html">IMEI Check</a></li>
      <li><a href="wiki.html" style="color: var(--accent-purple);">Wiki</a></li>
    </ul>
  </nav>

  <div class="hero">
    <h1 class="hero-title">Device Repair <span>Wiki</span></h1>
    <p class="hero-subtitle">Free repair guides, troubleshooting tips, and tutorials for technicians</p>
    <div class="search-container">
      <span class="search-icon">üîç</span>
      <input type="text" id="search-input" class="search-input" placeholder="Search repair guides...">
    </div>
  </div>

  <div class="container">
    <div class="categories" id="categories">
      <button class="category-btn active" data-category="">All</button>
    </div>

    <div class="results-header">
      <span class="results-count" id="results-count">Loading...</span>
    </div>

    <div id="articles-container" class="articles-grid">
      <div class="loading">Loading articles...</div>
    </div>
  </div>

  <script>
    const API_BASE = 'https://final-bice-phi.vercel.app';
    let currentCategory = '';
    let searchTimeout = null;

    async function loadArticles(query = '', category = '') {
      const container = document.getElementById('articles-container');
      container.innerHTML = '<div class="loading">Searching...</div>';

      try {
        const params = new URLSearchParams();
        if (query) params.append('q', query);
        if (category) params.append('category', category);

        const response = await fetch(`${API_BASE}/api/wiki/search?${params}`);
        const data = await response.json();

        if (data.success) {
          document.getElementById('results-count').textContent = `${data.total} article${data.total !== 1 ? 's' : ''} found`;

          // Render categories
          if (data.categories && !document.querySelector('[data-category="iPhone"]')) {
            const categoriesContainer = document.getElementById('categories');
            data.categories.forEach(cat => {
              const btn = document.createElement('button');
              btn.className = 'category-btn';
              btn.dataset.category = cat;
              btn.textContent = cat;
              btn.onclick = () => selectCategory(cat);
              categoriesContainer.appendChild(btn);
            });
          }

          // Render articles
          if (data.results.length === 0) {
            container.innerHTML = `
              <div class="no-results" style="grid-column: 1/-1;">
                <h3>No articles found</h3>
                <p>Try a different search term or category</p>
              </div>
            `;
          } else {
            container.innerHTML = data.results.map(article => `
              <div class="article-card" onclick="viewArticle('${article.id}')">
                <div class="article-category">${article.category} ‚Ä∫ ${article.subcategory}</div>
                <h3 class="article-title">${article.title}</h3>
                <p class="article-excerpt">${article.excerpt}</p>
                <div class="article-meta">
                  <span>‚è±Ô∏è ${article.timeEstimate}</span>
                  <span>üìä ${article.difficulty}</span>
                  <span>üëÅÔ∏è ${article.views.toLocaleString()}</span>
                </div>
              </div>
            `).join('');
          }
        }
      } catch (err) {
        console.error('Error loading articles:', err);
        container.innerHTML = '<div class="no-results"><h3>Error loading articles</h3><p>Please try again later</p></div>';
      }
    }

    function selectCategory(category) {
      currentCategory = category;
      document.querySelectorAll('.category-btn').forEach(btn => {
        btn.classList.toggle('active', btn.dataset.category === category);
      });
      loadArticles(document.getElementById('search-input').value, category);
    }

    function viewArticle(id) {
      // In a full implementation, this would navigate to an article page
      alert('Article viewer coming soon! Article ID: ' + id);
    }

    document.getElementById('search-input').addEventListener('input', (e) => {
      clearTimeout(searchTimeout);
      searchTimeout = setTimeout(() => {
        loadArticles(e.target.value, currentCategory);
      }, 300);
    });

    // Initial load
    loadArticles();
  </script>
</body>
</html>

