<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Settings | Fixology POS</title>
  <link rel="icon" type="image/webp" href="https://i.ibb.co/GfPnk0zV/preview.webp">
  <link rel="stylesheet" href="css/pos.css">
  <style>
    /* Settings Page Specific */
    .settings-grid {
      display: grid;
      grid-template-columns: 280px 1fr;
      gap: 32px;
    }

    /* Settings Navigation */
    .settings-nav {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 20px;
      padding: 16px;
      height: fit-content;
      position: sticky;
      top: 32px;
    }

    .settings-nav-item {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 14px 16px;
      border-radius: 12px;
      cursor: pointer;
      transition: var(--transition-normal);
      color: var(--text-secondary);
      font-weight: 500;
      position: relative;
      overflow: hidden;
    }

    .settings-nav-item::before {
      content: '';
      position: absolute;
      left: 0;
      top: 0;
      bottom: 0;
      width: 3px;
      background: var(--purple);
      transform: scaleY(0);
      transition: var(--transition-normal);
    }

    .settings-nav-item:hover {
      color: var(--text-primary);
      background: rgba(139, 92, 246, 0.05);
    }

    .settings-nav-item.active {
      color: var(--text-primary);
      background: rgba(139, 92, 246, 0.1);
    }

    .settings-nav-item.active::before { transform: scaleY(1); }

    .settings-nav-item .icon { font-size: 18px; }

    /* Settings Content */
    .settings-content {
      display: flex;
      flex-direction: column;
      gap: 24px;
    }

    .settings-section {
      background: var(--bg-card);
      border: 1px solid var(--border-subtle);
      border-radius: 20px;
      overflow: hidden;
      transition: var(--transition-smooth);
    }

    .settings-section:hover {
      border-color: var(--border-accent);
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    }

    .section-header {
      padding: 24px;
      border-bottom: 1px solid var(--border-subtle);
      display: flex;
      align-items: center;
      gap: 16px;
    }

    .section-icon {
      width: 48px;
      height: 48px;
      border-radius: 14px;
      background: linear-gradient(135deg, rgba(139, 92, 246, 0.2), rgba(139, 92, 246, 0.05));
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 22px;
      position: relative;
      transition: var(--transition-normal);
    }

    .section-icon-ring {
      position: absolute;
      inset: -4px;
      border: 2px solid var(--purple);
      border-radius: 18px;
      opacity: 0;
      transform: rotate(0deg);
      transition: var(--transition-smooth);
    }

    .settings-section:hover .section-icon-ring {
      opacity: 0.5;
      transform: rotate(90deg);
    }

    .settings-section:hover .section-icon { transform: scale(1.05); }

    .section-info { flex: 1; }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .section-desc {
      font-size: 13px;
      color: var(--text-muted);
    }

    .section-body {
      padding: 24px;
    }

    .setting-row {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 16px 0;
      border-bottom: 1px solid var(--border-subtle);
    }

    .setting-row:last-child { border-bottom: none; }

    .setting-info { flex: 1; }

    .setting-label {
      font-weight: 500;
      color: var(--text-primary);
      margin-bottom: 4px;
    }

    .setting-desc {
      font-size: 13px;
      color: var(--text-muted);
    }

    /* Toggle Switch */
    .toggle {
      width: 52px;
      height: 28px;
      background: rgba(255, 255, 255, 0.1);
      border-radius: 14px;
      position: relative;
      cursor: pointer;
      transition: var(--transition-normal);
    }

    .toggle.active {
      background: var(--purple);
      box-shadow: 0 4px 15px var(--purple-glow);
    }

    .toggle::after {
      content: '';
      position: absolute;
      width: 22px;
      height: 22px;
      background: white;
      border-radius: 50%;
      top: 3px;
      left: 3px;
      transition: var(--transition-normal);
    }

    .toggle.active::after {
      left: 27px;
    }

    /* Data Export/Import */
    .data-actions {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
    }

    .data-btn {
      padding: 12px 20px;
      border-radius: 12px;
      background: rgba(139, 92, 246, 0.1);
      border: 1px solid var(--border-accent);
      color: var(--text-primary);
      font-weight: 500;
      cursor: pointer;
      transition: var(--transition-normal);
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .data-btn:hover {
      background: rgba(139, 92, 246, 0.2);
      transform: translateY(-2px);
    }

    .data-btn.danger {
      background: rgba(239, 68, 68, 0.1);
      border-color: rgba(239, 68, 68, 0.2);
      color: var(--red);
    }

    .data-btn.danger:hover {
      background: rgba(239, 68, 68, 0.2);
    }

    /* Version Info */
    .version-info {
      text-align: center;
      padding: 24px;
      color: var(--text-muted);
      font-size: 13px;
    }

    .version-info strong {
      color: var(--purple-light);
    }

    @media (max-width: 1024px) {
      .settings-grid {
        grid-template-columns: 1fr;
      }
      .settings-nav {
        position: static;
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
      }
      .settings-nav-item {
        flex: 1;
        min-width: 120px;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <div class="pos-app">
    <!-- Sidebar -->
    <aside class="pos-sidebar">
      <div class="sidebar-header">
        <a href="index.html" class="sidebar-logo">
          <img src="https://i.ibb.co/GfPnk0zV/preview.webp" alt="Fixology">
          <span>Fixology</span>
        </a>
      </div>
      <nav class="sidebar-nav">
        <div class="nav-section">
          <a href="index.html" class="nav-link"><span class="icon">üìä</span><span>Dashboard</span></a>
          <a href="tickets.html" class="nav-link"><span class="icon">üé´</span><span>Tickets</span></a>
          <a href="customers.html" class="nav-link"><span class="icon">üë•</span><span>Customers</span></a>
          <a href="inventory.html" class="nav-link"><span class="icon">üì¶</span><span>Inventory</span></a>
        </div>
        <div class="nav-section">
          <a href="settings.html" class="nav-link active"><span class="icon">‚öôÔ∏è</span><span>Settings</span></a>
        </div>
      </nav>
      <div class="sidebar-footer">
        <div class="sidebar-user">
          <div class="avatar">F</div>
          <div class="info">
            <div class="name">Fixology</div>
            <div class="role">Admin</div>
          </div>
        </div>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="pos-main">
      <header class="pos-header">
        <div class="header-left">
          <h1 class="header-title">‚öôÔ∏è Settings</h1>
        </div>
      </header>

      <div class="pos-content">
        <div class="settings-grid">
          <!-- Settings Nav -->
          <div class="settings-nav">
            <div class="settings-nav-item active" data-section="shop">
              <span class="icon">üè™</span>
              <span>Shop Info</span>
            </div>
            <div class="settings-nav-item" data-section="pricing">
              <span class="icon">üí∞</span>
              <span>Pricing</span>
            </div>
            <div class="settings-nav-item" data-section="notifications">
              <span class="icon">üîî</span>
              <span>Notifications</span>
            </div>
            <div class="settings-nav-item" data-section="data">
              <span class="icon">üíæ</span>
              <span>Data</span>
            </div>
          </div>

          <!-- Settings Content -->
          <div class="settings-content">
            <!-- Shop Info -->
            <div class="settings-section" id="section-shop">
              <div class="section-header">
                <div class="section-icon">
                  <div class="section-icon-ring"></div>
                  üè™
                </div>
                <div class="section-info">
                  <div class="section-title">Shop Information</div>
                  <div class="section-desc">Your repair shop details</div>
                </div>
              </div>
              <div class="section-body">
                <div class="form-group">
                  <label class="form-label">Shop Name</label>
                  <input type="text" class="form-input" id="shop-name" placeholder="Fixology STL">
                </div>
                <div class="form-group">
                  <label class="form-label">Phone Number</label>
                  <input type="tel" class="form-input" id="shop-phone" placeholder="(314) 555-1234">
                </div>
                <div class="form-group">
                  <label class="form-label">Email</label>
                  <input type="email" class="form-input" id="shop-email" placeholder="hello@fixology.com">
                </div>
                <div class="form-group">
                  <label class="form-label">Address</label>
                  <input type="text" class="form-input" id="shop-address" placeholder="123 Main St, St. Louis, MO 63033">
                </div>
                <button class="btn btn-primary" onclick="saveShopInfo()">Save Changes</button>
              </div>
            </div>

            <!-- Pricing -->
            <div class="settings-section" id="section-pricing">
              <div class="section-header">
                <div class="section-icon" style="background: linear-gradient(135deg, rgba(16,185,129,0.2), rgba(16,185,129,0.05));">
                  <div class="section-icon-ring" style="border-color: #10b981;"></div>
                  üí∞
                </div>
                <div class="section-info">
                  <div class="section-title">Pricing Rules</div>
                  <div class="section-desc">Default pricing and tax settings</div>
                </div>
              </div>
              <div class="section-body">
                <div class="form-group">
                  <label class="form-label">Default Labor Rate ($/hour)</label>
                  <input type="number" class="form-input" id="labor-rate" value="75" step="5">
                </div>
                <div class="form-group">
                  <label class="form-label">Tax Rate (%)</label>
                  <input type="number" class="form-input" id="tax-rate" value="8" step="0.1">
                </div>
                <div class="form-group">
                  <label class="form-label">Default Warranty (days)</label>
                  <input type="number" class="form-input" id="warranty-days" value="90">
                </div>
                <button class="btn btn-primary" onclick="savePricing()">Save Changes</button>
              </div>
            </div>

            <!-- Notifications -->
            <div class="settings-section" id="section-notifications">
              <div class="section-header">
                <div class="section-icon" style="background: linear-gradient(135deg, rgba(245,158,11,0.2), rgba(245,158,11,0.05));">
                  <div class="section-icon-ring" style="border-color: #f59e0b;"></div>
                  üîî
                </div>
                <div class="section-info">
                  <div class="section-title">Notifications</div>
                  <div class="section-desc">Manage notification preferences</div>
                </div>
              </div>
              <div class="section-body">
                <div class="setting-row">
                  <div class="setting-info">
                    <div class="setting-label">SMS Notifications</div>
                    <div class="setting-desc">Send SMS updates to customers on status changes</div>
                  </div>
                  <div class="toggle active" onclick="toggleSetting(this, 'sms')"></div>
                </div>
                <div class="setting-row">
                  <div class="setting-info">
                    <div class="setting-label">Email Notifications</div>
                    <div class="setting-desc">Send email receipts and updates</div>
                  </div>
                  <div class="toggle" onclick="toggleSetting(this, 'email')"></div>
                </div>
                <div class="setting-row">
                  <div class="setting-info">
                    <div class="setting-label">Low Stock Alerts</div>
                    <div class="setting-desc">Get notified when parts are running low</div>
                  </div>
                  <div class="toggle active" onclick="toggleSetting(this, 'lowstock')"></div>
                </div>
                <div class="setting-row">
                  <div class="setting-info">
                    <div class="setting-label">Sound Effects</div>
                    <div class="setting-desc">Play sounds for new tickets and alerts</div>
                  </div>
                  <div class="toggle" onclick="toggleSetting(this, 'sounds')"></div>
                </div>
              </div>
            </div>

            <!-- Data Management -->
            <div class="settings-section" id="section-data">
              <div class="section-header">
                <div class="section-icon" style="background: linear-gradient(135deg, rgba(59,130,246,0.2), rgba(59,130,246,0.05));">
                  <div class="section-icon-ring" style="border-color: #3b82f6;"></div>
                  üíæ
                </div>
                <div class="section-info">
                  <div class="section-title">Data Management</div>
                  <div class="section-desc">Export, import, or reset your data</div>
                </div>
              </div>
              <div class="section-body">
                <div class="data-actions">
                  <button class="data-btn" onclick="exportData()">
                    üì§ Export All Data
                  </button>
                  <button class="data-btn" onclick="importData()">
                    üì• Import Data
                  </button>
                  <button class="data-btn danger" onclick="clearData()">
                    üóëÔ∏è Clear All Data
                  </button>
                </div>
                <input type="file" id="import-file" accept=".json" style="display: none;" onchange="handleImport(event)">
              </div>
            </div>

            <!-- Version Info -->
            <div class="version-info">
              <p>Fixology POS v1.0.0</p>
              <p>Made with üíú by <strong>Fixology AI</strong></p>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>

  <script src="js/pos-data.js"></script>
  <script src="js/pos-core.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      loadSettings();
      setupNavigation();
    });

    function setupNavigation() {
      document.querySelectorAll('.settings-nav-item').forEach(item => {
        item.addEventListener('click', () => {
          document.querySelectorAll('.settings-nav-item').forEach(i => i.classList.remove('active'));
          item.classList.add('active');
          
          const section = item.dataset.section;
          const el = document.getElementById(`section-${section}`);
          if (el) {
            el.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        });
      });
    }

    function loadSettings() {
      const settings = JSON.parse(localStorage.getItem('fixology_settings') || '{}');
      
      document.getElementById('shop-name').value = settings.shopName || '';
      document.getElementById('shop-phone').value = settings.shopPhone || '';
      document.getElementById('shop-email').value = settings.shopEmail || '';
      document.getElementById('shop-address').value = settings.shopAddress || '';
      document.getElementById('labor-rate').value = settings.laborRate || 75;
      document.getElementById('tax-rate').value = settings.taxRate || 8;
      document.getElementById('warranty-days').value = settings.warrantyDays || 90;
    }

    function saveShopInfo() {
      const settings = JSON.parse(localStorage.getItem('fixology_settings') || '{}');
      settings.shopName = document.getElementById('shop-name').value;
      settings.shopPhone = document.getElementById('shop-phone').value;
      settings.shopEmail = document.getElementById('shop-email').value;
      settings.shopAddress = document.getElementById('shop-address').value;
      localStorage.setItem('fixology_settings', JSON.stringify(settings));
      POS.success('Shop info saved');
    }

    function savePricing() {
      const settings = JSON.parse(localStorage.getItem('fixology_settings') || '{}');
      settings.laborRate = parseFloat(document.getElementById('labor-rate').value);
      settings.taxRate = parseFloat(document.getElementById('tax-rate').value);
      settings.warrantyDays = parseInt(document.getElementById('warranty-days').value);
      localStorage.setItem('fixology_settings', JSON.stringify(settings));
      POS.success('Pricing settings saved');
    }

    function toggleSetting(el, key) {
      el.classList.toggle('active');
      const settings = JSON.parse(localStorage.getItem('fixology_settings') || '{}');
      settings[key] = el.classList.contains('active');
      localStorage.setItem('fixology_settings', JSON.stringify(settings));
    }

    function exportData() {
      const data = {
        tickets: POS_DATA.getTickets(),
        customers: POS_DATA.getCustomers(),
        inventory: POS_DATA.getInventory(),
        settings: JSON.parse(localStorage.getItem('fixology_settings') || '{}'),
        exportedAt: new Date().toISOString()
      };

      const blob = new Blob([JSON.stringify(data, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `fixology-backup-${new Date().toISOString().split('T')[0]}.json`;
      a.click();
      URL.revokeObjectURL(url);
      POS.success('Data exported successfully');
    }

    function importData() {
      document.getElementById('import-file').click();
    }

    function handleImport(event) {
      const file = event.target.files[0];
      if (!file) return;

      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          const data = JSON.parse(e.target.result);
          
          if (data.tickets) localStorage.setItem('fixology_tickets', JSON.stringify(data.tickets));
          if (data.customers) localStorage.setItem('fixology_customers', JSON.stringify(data.customers));
          if (data.inventory) localStorage.setItem('fixology_inventory', JSON.stringify(data.inventory));
          if (data.settings) localStorage.setItem('fixology_settings', JSON.stringify(data.settings));
          
          POS.success('Data imported successfully');
          loadSettings();
        } catch (err) {
          POS.error('Invalid backup file');
        }
      };
      reader.readAsText(file);
      event.target.value = '';
    }

    function clearData() {
      if (!confirm('Are you sure? This will delete ALL your data including tickets, customers, and inventory. This cannot be undone!')) {
        return;
      }

      localStorage.removeItem('fixology_tickets');
      localStorage.removeItem('fixology_customers');
      localStorage.removeItem('fixology_inventory');
      localStorage.removeItem('fixology_settings');
      
      POS.success('All data cleared');
      loadSettings();
    }
  </script>
</body>
</html>
